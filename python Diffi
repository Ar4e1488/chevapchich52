# Функция для вычисления a^b mod p
def power(a, b, p):
    if b == 1:
        return a
    else:
        return pow(a, b, p)

# Общедоступные значения P и G
P = 23  # Простое число
G = 9   # Первообразный корень по модулю P

# Секретные ключи Алисы и Боба
a = 4  # Секретный ключ Алисы
b = 3  # Секретный ключ Боба

# Алиса вычисляет открытый ключ
x = power(G, a, P)

# Боб вычисляет открытый ключ
y = power(G, b, P)

# Алиса вычисляет общий секретный ключ
ka = power(y, a, P)

# Боб вычисляет общий секретный ключ
kb = power(x, b, P)

print(f"Секретный ключ Алисы: {ka}")
print(f"Секретный ключ Боба: {kb}")
